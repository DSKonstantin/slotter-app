# .github/copilot-review.md
#
# Expo / React Native review instructions (high-signal, low-noise)
# Review ONLY the PR diff. Don’t comment on unrelated code.

## Priorities (in this order)

### 1) Correctness / Bugs (BLOCKER if risky)
- Null/undefined, stale closures, wrong dependency arrays
- State updates after unmount, memory leaks in effects
- Incorrect async flows (missing awaits, race conditions, double submits)
- Navigation edge cases (deep links, back behavior, modals)
- Date/time & locale issues, rounding/precision problems

### 2) Mobile Performance (IMPORTANT)
- Unnecessary re-renders (missing memo/useCallback/useMemo where it matters)
- Heavy work on the JS thread (loops, JSON parsing, image ops) in render/effects
- FlatList/SectionList issues (missing `keyExtractor`, unstable `renderItem`, no virtualization hints)
- Images: missing sizing, no caching strategy, large assets, re-encoding
- Animations: prefer Reanimated for high-frequency animations; avoid setState per-frame

### 3) Expo-specific reliability (IMPORTANT)
- Config / permissions: `app.json` / `app.config.js` correctness (iOS/Android permissions, schemes)
- EAS build compatibility: native deps, config plugins, runtime versions
- Over-the-air updates (EAS Update): ensure no native-required changes shipped via OTA

### 4) Security / Privacy (BLOCKER)
- No secrets in client bundle (API keys, tokens, private URLs)
- Avoid logging PII / auth tokens (especially in production)
- Secure storage: use `expo-secure-store` (or platform keychain) for sensitive tokens
- Deep link & auth: validate redirect URIs, prevent open redirects

### 5) UX & Accessibility (IMPORTANT/NIT)
- Loading / error states (no silent failures)
- Disabled states for submit buttons to prevent double actions
- Accessible labels for touchables/icons where relevant
- Safe area / small screens / dynamic font sizes

## Don’t comment on
- Formatting, whitespace, trivial lint/prettier issues
- Pure style preferences that don’t affect correctness
- Generated files, lockfiles, build artifacts:
    - `yarn.lock`, `package-lock.json`, `pnpm-lock.yaml`
    - `ios/`, `android/` (if generated by prebuild and not intentionally edited)
    - `dist/`, `build/`, `.expo/`

## Code review style
- Be concise and actionable.
- Use severity tags:
    - **BLOCKER**: must fix before merge
    - **IMPORTANT**: should fix soon
    - **NIT**: optional, only if it meaningfully improves clarity
- For each issue: 1–2 sentences explaining risk + a concrete fix (snippet if small).

## Testing expectations
If PR touches critical flows (auth, payments, camera/scanner, push notifications, analytics):
- Ask for at least one:
    - unit tests (where feasible)
    - a short manual test plan (device + OS)
    - screenshot/video for UI changes

## Expo / RN check list (flag if missing)
- Permissions and config updates included when adding new native features
- Correct environment handling (no secrets in `process.env` shipped to client)
- `Platform` differences handled (iOS vs Android)
- Network errors handled (timeouts, retries, user messaging)
- Analytics events: no PII, consistent naming

## Output format
- Start with a short summary (max 3–5 bullets)
- Then findings grouped by severity: BLOCKER → IMPORTANT → NIT
- If no high-risk issues: “✅ Looks good. No high-risk issues found.”
